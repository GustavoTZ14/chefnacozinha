---
import type { GetStaticPaths } from "astro";
import Layout from "../layouts/Layout.astro";
import "../styles/global.css";

interface TabelaCompleta {
  receita_id: number;
  lista: string;
}

const resp = await fetch('http://localhost:4321/API/tableComplete');
const tabelaCompleta: TabelaCompleta[] = await resp.json();

export const getStaticPaths: GetStaticPaths = async () => {

interface TabelaTitulo {
  slug: string;
  title: string;
  id: number;
}

const res = await fetch('http://localhost:4321/API/tableTitle'); // URL absoluta em build
const tabelaTitulos: TabelaTitulo[] = await res.json();

return tabelaTitulos.map(({ slug, title, id }) => ({
    params: { slug },
    props: { title, id },
  }));
};

const { title, id } = Astro.props;

const filtID = tabelaCompleta.filter(({receita_id}) => receita_id === id);
---

<Layout title={title}>
  <h1 class="font-bold mb-5">{title}</h1>
  <h4 class="font-bold mb-2">Ingredientes:</h4>
  <ul>
    {filtID.map(({lista}) => <li>{lista}</li>)}
  </ul>
</Layout>
